{% extends "_base.html" %}

{% block title %}{{ forum.name }}{% endblock %}

{% block content %}
    {% if g.user and g.user.admin %}
        <div class="forum-admin">
            <a href="{{url_for('edit_forum', forum_id=forum.id)}}">Editovat fórum</a>
        </div>
    {% endif %}
    <h1><a href="/forum/">RHForum</a> » <a href="{{forum.url}}">{{forum.name}}</a></h1>
    <div class="threads">
        {% for thread in threads %}
            <div class="row">
                <div class="row-data">
                    <div class="row-total">{{ thread.posts | count }} příspěvků</div>
                    <div class="row-last" title="{{thread.laststamp|datetime}}">Nejnovější: <a href="{{thread.posts[-1].url}}"> od {{ thread.posts[-1].author.name }}</a></div>
                </div>
                <a class="row-text" href="{{thread.url}}">
                    <div class="row-name">{{thread.name}} <span class="author" href="#">{{thread.author.name}}</span></div>
                    <div class="row-description">{{thread.description or "&nbsp;"|safe}} </div>
                </a>
            </div>
        {% endfor %}
    </div>
    {% if g.user %}
        <h2>Nové téma</h2>
        <form method="POST" class="new-thread">
            {{ form.name(tabindex=1) }}
            <div class="post">
                <div class="post-sidebar">
                    <div><a href="{{ g.user.url }}">{{ g.user.name }}</a></div>
                </div>
                    <div class="post-contents">
                        <div class="post-data">
                            {{ now | datetime }}
                        </div>
                        <div class="post-text">
                            {{ form.text(tabindex=2) }}
                        </div>
                        <div class="newpost-controls">
                            {{ form.submit(tabindex=3) }}
                        </div>
                    </div>
                </div>
            </div>
        </form>
    {% endif %}
{% endblock %}
